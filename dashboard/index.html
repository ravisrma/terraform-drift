<!DOCTYPE html>
<html>
<head>
  <title>Terraform Drift Dashboard</title>
  <style>
    body { font-family: Arial; }
    .clean { color: green; }
    .drift { color: red; }
    .remediated { color: orange; }
  </style>
</head>
<body>
<h1>Terraform Drift Dashboard</h1>
<div id="content"></div>

<script>
async function load() {
  const envs = ["dev","preprod","prod"];
  let output = "";
  for (let env of envs) {
    try {
      let res = await fetch(env + ".json");
      let data = await res.json();
      // Map drift exitcode to status: 0=clean, 2=drift
      let status = data.drift === "0" ? "clean" : "drift";
      output += `<p><b>${env}</b> :
        <span class="${status}">${status}</span>
        (Last run: ${data.timestamp})</p>`;
    } catch (e) {
      output += `<p><b>${env}</b> : <span>No data</span></p>`;
    }
  }
  document.getElementById("content").innerHTML = output;
}
load();
</script>
</body>
</html>